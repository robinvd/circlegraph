<!DOCTYPE HTML>
<html>
  <meta charset="UTF-8"> 
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  
   <script src="./svg.min.js"></script> 
  <body>
    <textarea rows="20" cols="60" id='data'>
[
  { 
    "label": "basic1",
    "scale": {"start": 2, "end":10},
    "value": 5.5,
    "steps": 10
  },
  { 
    "label": "basic2",
    "scale": {"start": 5, "end":10},
    "value": 8,
    "steps": 10
  },
  { 
    "label": "basic3",
    "scale": {"start": 0, "end":10},
    "value": 10,
    "steps": 10
  },
  { 
    "label": "more steps",
    "scale": {"start": 0, "end":10},
    "value": 5,
    "steps": 15
  },
  { 
    "label": "inverted",
    "scale": {"start": 10, "end":0},
    "value": 2,
    "steps": 10
  }
]
    </textarea>
    <textarea rows="20" cols="60" id='style'>
{ 
  "stroke_style": {"width": 1, "color": "#2c3e50"},
  "area_style": {"color": "#f44336", "opacity": 1},
  "circle_style": {"width": 1,"color": "#03A9F4"},
  "text_style": {
    "font": {
      "family":   "Helvetica",
      "size":     20,
      "anchor":   "start"
    }
  },
  "label_offset": 25
}
    </textarea>
    <textarea rows="20" cols="60" id='output'>
      sgv output
    </textarea>
    <button onclick="run()">run</button> 
    <div id="drawing"></div>
    <script>
function run() {
  // var stroke_style = {width:1, color:'#ccc'}
  var radius = 400
  var padding = 50
  var center = {x: (radius) + padding, y:(radius) + padding}
  var data = JSON.parse(document.getElementById("data").value)
  var style = JSON.parse(document.getElementById("style").value)

  document.getElementById("drawing").innerHTML = ''
  var draw = SVG('drawing').size(radius*2 + padding*2, radius*2 + padding*2)

  var circle = draw.circle(radius*2).center(center.x, center.y).fill(style.circle_style)// .stroke(style.circle_style)
  var points = []

  // already make the polygon so it is in the background
  var polygon = draw.polygon([])

  for (var i=0; i< data.length; i++) {
    var d = data[i]
    var a = Math.PI/data.length*i*2
    var pos = r => [Math.cos(a)*r + center.x, Math.sin(a)*r + center.y]

    draw.line(center.x, center.y, ...pos(radius)).stroke(style.stroke_style)

    var rot = a*180/Math.PI
    if (rot < 180) {
      rot += 180
    }
    draw.plain(d.label).font(style.text_style.font).center(...pos(radius + style.label_offset)).rotate(rot + 90)

    var step_size = (d.scale.end - d.scale.start) / d.steps
    for (var j=1; j<d.steps; j++) {
      var r = radius /d.steps * j
      var num = step_size * j + d.scale.start
      draw.plain((num).toFixed(1)).font(style.text_style.font).center(Math.cos(a)*r + center.x, Math.sin(a)*r + center.y)
    }

    var r = (d.value - d.scale.start) / (d.scale.end - d.scale.start) * radius
    points[i] = pos(r)
  }

  polygon.plot([].concat(...points)).stroke('none').fill(style.area_style.color).opacity(style.area_style.opacity)

  document.getElementById("output").value = draw.svg()
}


run()
    </script>
  </body>
</html> 
